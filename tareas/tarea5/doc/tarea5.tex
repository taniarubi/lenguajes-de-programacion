\documentclass[letterpaper,11pt]{article}

% Soporte para los acentos.
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
% Idioma español.
\usepackage[spanish,mexico, es-tabla]{babel}
% Soporte de símbolos adicionales (matemáticas)
\usepackage{amsmath}
\usepackage[dvipsnames]{xcolor}
% Modificamos los márgenes del documento.                                       
\usepackage[lmargin=1.5cm,rmargin=1.5cm,top=1.5cm,bottom=1.5cm]{geometry}

\title{Facultad de Ciencias, UNAM \\ 
       Lenguajes de Programación\\ 
       Tarea 5}
\author{Rubí Rojas Tania Michelle}
\date{07 de diciembre de 2020}

\begin{document}
\maketitle

\begin{enumerate}
    % Ejercicio 1.
    \item Evalúa la siguiente expresión usando el tipo de alcance y régimen de 
    evaluación que se indica. Es necesario incluir el ambiente final en forma 
    de pila en cada caso. 
    \begin{verbatim}
    {with {a {+ 2 2}}
       {with {b {+ a a}}
          {with {foo {fun {x} {- x b}}
             {with {a {- 2 2}}
                {with {b {- a a}}
                   {foo -3}}}}}}}
    \end{verbatim}

    \begin{enumerate}
        % Ejercicio 1.a
        \item Alcance estático y evaluación glotona

        \textsc{Solución:} La expresión que debemos evaluar es 
        \texttt{\{foo -3\}}, por lo que 
        \begin{table}[h]
            \parbox{.55\linewidth}{
            \centering
            \begin{align*}
                \texttt{\{foo -3\}} 
                &= \texttt{\{\{fun \{x\} \{- x b\}\} -3\}} \\
                &= \texttt{\{- (-3) b\}} \\
                &= \texttt{\{- (-3) 8\}} \\
                &= -11
            \end{align*}
            }
            \hfill
            \parbox{.45\linewidth}{
            \centering
            \begin{tabular}{|c|c|}
            \hline
            \texttt{b} & \texttt{0} \\
            \hline
            \texttt{a} & \texttt{0} \\
            \hline
            \texttt{foo} & \texttt{[closureV: x,\{-x b\},} \\
             & \texttt{env-ant:((x -3),(b 8),(a 4))]} \\
            \hline
            \texttt{b} & \texttt{8} \\
            \hline
            \texttt{a} & \texttt{4} \\
            \hline
            \end{tabular}
            \caption{Ambiente final}
            }
        \end{table}

        % Ejercicio 1.b
        \item Alcance dinámico y evaluación glotona 

        \textsc{Solución:} La expresión que debemos evaluar es 
        \texttt{\{foo -3\}}, por lo que 
        \begin{table}[h]
            \parbox{.55\linewidth}{
            \centering
            \begin{align*}
                \texttt{\{foo -3\}}
                &= \texttt{\{\{fun \{x\} \{- x b\}\} -3\}} \\
                &= \texttt{\{- (-3) b\}} \\
                &= \texttt{\{- (-3) 0\}} \\ 
                &= \texttt{-3}
            \end{align*}
            }
            \hfill
            \parbox{.45\linewidth}{
            \centering
            \begin{tabular}{|c|c|}
                \hline
                \texttt{x} & \texttt{-3} \\
                \hline
                \texttt{b} & \texttt{0} \\
                \hline
                \texttt{a} & \texttt{0} \\
                \hline
                \texttt{foo} & \texttt{\{fun \{x\} \{- x b\}\}} \\
                \hline
                \texttt{b} & \texttt{8} \\
                \hline
                \texttt{a} & \texttt{4} \\
                \hline
            \end{tabular}
            \caption{Ambiente final}
            }
        \end{table}

        \newpage
        % Ejercicio 1.c
        \item Alcance estático y evaluación perezosa

        \textsc{Solución:} La expresión que debemos evaluar es 
        \texttt{\{foo -3\}}, por lo que 
        \begin{table}[h]
            \parbox{.6\linewidth}{
            \centering
            \begin{align*}
                \texttt{\{foo -3\}}
                &= \texttt{\{\{fun \{x\} \{- x b\}\} -3\}} \\
                &= \texttt{\{- (-3) b\}} \\
                &= \texttt{\{- (-3) \{+ a a\}\}} \\
                &= \texttt{\{- (-3) \{+ \{+ 2 2\} \{+ 2 2\}\}\}} \\
                &= \texttt{\{- (-3) \{+ 4 4\}\}} \\
                &= \texttt{\{- (-3) 8\}} \\
                &= \texttt{-11}
            \end{align*}
            }
            \hfill
            \parbox{.4\linewidth}{
            \centering
            \begin{tabular}{|c|c|}
                \hline
                \texttt{b} & \texttt{\{- a a\}} \\
                \hline
                \texttt{a} & \texttt{\{- 2 2\}} \\
                \hline
                \texttt{foo} & \texttt{[closureV: x,\{-x b\},} \\
                & \texttt{env-ant:((x -3),(b \{+ a a\}),} \\
                & \texttt{(a \{+ 2 2\}))]} \\
                \hline
                \texttt{b} & \texttt{\{+ a a\}} \\
                \hline
                \texttt{a} & \texttt{\{+ 2 2\}} \\
                \hline
            \end{tabular}
            \caption{Ambiente final}
            }
        \end{table}

        % Ejercicio 1.d
        \item Alcance dinámico y evaluación perezosa

        \textsc{Solución:} La expresión que debemos evaluar es 
        \texttt{\{foo -3\}}, por lo que 
        \begin{table}[h]
            \parbox{.6\linewidth}{
            \centering
            \begin{align*}
                \texttt{\{foo -3\}}
                &= \texttt{\{\{fun \{x\} \{- x b\}\} -3\}} \\
                &= \texttt{\{- (-3) b\}} \\
                &= \texttt{\{- (-3) \{- a a\}\}} \\
                &= \texttt{\{- (-3) \{- \{- 2 2\} \{- 2 2\}\}\}} \\
                &= \texttt{\{- (-3) \{- 0 0\}\}} \\
                &= \texttt{\{- (-3) 0\}} \\
                &= \texttt{-3}
            \end{align*}
            }
            \hfill
            \parbox{.4\linewidth}{
            \centering
            \begin{tabular}{|c|c|}
                \hline
                \texttt{x} & \texttt{-3} \\
                \hline
                \texttt{b} & \texttt{\{- a a\}} \\
                \hline
                \texttt{a} & \texttt{\{- 2 2\}} \\
                \hline
                \texttt{foo} & \texttt{\{fun \{x\} \{- x b\}\}} \\
                \hline
                \texttt{b} & \texttt{\{+ a a\}} \\
                \hline
                \texttt{a} & \texttt{\{+ 2 2\}} \\
                \hline
            \end{tabular}
            \caption{Ambiente final}
            }
        \end{table}
    \end{enumerate}

    % Ejercicio 2.
    \item Dada la siguiente función:
    \begin{verbatim}
    (define (goo l)
        (if (empty? l)
            empty
            (append (car l) (goo (cdr l)))))
    \end{verbatim}

    \begin{enumerate}
        % Ejercicio 2.a
        \item Explica qué hace y dale un nombre mnemotécnico.

        \textsc{Solución:} Por cómo está definida la función \texttt{goo}, 
        ésta debe recibir una lista de listas; por lo que \texttt{goo} hará 
        la concatenación de las listas de la lista $l$, es decir, regresa una 
        lista con todos los elementos de las listas de la lista $l$ de acuerdo 
        a su órden de aparición en su respectiva lista. Así, un nombre 
        mnemotécnico para esta función podría ser 
        \texttt{concatena-listas-de-lista}. Por lo tanto, nuestra función 
        queda de la siguiente forma:
        \begin{verbatim}
            (define (concatena-listas-de-lista l)
                (if (empty? l)
                    empty
                    (append (car l) (concatena-listas-de-lista (cdr l)))))
        \end{verbatim}

        \newpage
        % Ejercicio 2.b
        \item Muestra los registros generados cuando es llamada con el argumento
        \texttt{'((1 2) (3 4) (4 6))}. ¿Cuántos registros son generados? ¿Cuántos 
        son ocupados a la vez?

        \textsc{Solución:} Veamos que se generan $8$ registros de activación
        ($4$ de entrada y $4$ de salida), y ningún registro es ocupado a la vez.

        Ingresa \texttt{(concatena-listas-de-lista '((1 2) (3 4) (4 6)))}
        \begin{center}
            \begin{tabular}{|c|}
                \hline
                \texttt{(append '(1 2) 
                (concatena-listas-de-lista '((3 4) (4 6))))}  \\
                \texttt{(if (empty? l) empty} \\
                \texttt{(append (car l) (concatena-listas-de-lista (cdr l))))} \\
                \texttt{l = '((1 2) (3 4) (4 6))} \\
                \texttt{concatena-listas-de-lista} \\
                \hline
            \end{tabular}
        \end{center}

        Ingresa \texttt{(concatena-listas-de-lista '((3 4) (4 6)))}
        \begin{center}
            \begin{tabular}{|c|}
                \hline
                \texttt{(append '(3 4) 
                (concatena-listas-de-lista '((4 6))))}  \\
                \texttt{(if (empty? l) empty} \\
                \texttt{(append (car l) (concatena-listas-de-lista (cdr l))))} \\
                \texttt{l = '((3 4) (4 6))} \\
                \texttt{concatena-listas-de-lista} \\
                \hline
                \hline
                \texttt{(append '(1 2) 
                (concatena-listas-de-lista '((3 4) (4 6))))}  \\
                \texttt{(if (empty? l) empty} \\
                \texttt{(append (car l) (concatena-listas-de-lista (cdr l))))} \\
                \texttt{l = '((1 2) (3 4) (4 6))} \\
                \texttt{concatena-listas-de-lista} \\
                \hline
            \end{tabular}
        \end{center}

        Ingresa \texttt{(concatena-listas-de-lista '((4 6)))}
        \begin{center}
            \begin{tabular}{|c|}
                \hline
                \texttt{(append '(4 6) (concatena-listas-de-lista '()))} \\
                \texttt{(if (empty? l) empty} \\
                \texttt{(append (car l) (concatena-listas-de-lista (cdr l))))} \\
                \texttt{l = '((4 6))} \\
                \texttt{concatena-listas-de-lista} \\
                \hline
                \hline
                \texttt{(append '(3 4) 
                (concatena-listas-de-lista '((4 6))))}  \\
                \texttt{(if (empty? l) empty} \\
                \texttt{(append (car l) (concatena-listas-de-lista (cdr l))))} \\
                \texttt{l = '((3 4) (4 6))} \\
                \texttt{concatena-listas-de-lista} \\
                \hline
                \hline
                \texttt{(append '(1 2) 
                (concatena-listas-de-lista '((3 4) (4 6))))}  \\
                \texttt{(if (empty? l) empty} \\
                \texttt{(append (car l) (concatena-listas-de-lista (cdr l))))} \\
                \texttt{l = '((1 2) (3 4) (4 6))} \\
                \texttt{concatena-listas-de-lista} \\
                \hline
            \end{tabular}
        \end{center}

        \newpage
        Ingresa \texttt{(concatena-listas-de-lista '())}
        \begin{center}
            \begin{tabular}{|c|}
                \hline
                \texttt{'()}  \\
                \texttt{(if (empty? l) empty} \\
                \texttt{(append (car l) (concatena-listas-de-lista (cdr l))))} \\
                \texttt{l = '()} \\
                \texttt{concatena-listas-de-lista} \\
                \hline
                \hline
                \texttt{(append '(4 6) (concatena-listas-de-lista '()))} \\
                \texttt{(if (empty? l) empty} \\
                \texttt{(append (car l) (concatena-listas-de-lista (cdr l))))} \\
                \texttt{l = '((4 6))} \\
                \texttt{concatena-listas-de-lista} \\
                \hline
                \hline
                \texttt{(append '(3 4) 
                (concatena-listas-de-lista '((4 6))))}  \\
                \texttt{(if (empty? l) empty} \\
                \texttt{(append (car l) (concatena-listas-de-lista (cdr l))))} \\
                \texttt{l = '((3 4) (4 6))} \\
                \texttt{concatena-listas-de-lista} \\
                \hline
                \hline
                \texttt{(append '(1 2) 
                (concatena-listas-de-lista '((3 4) (4 6))))}  \\
                \texttt{(if (empty? l) empty} \\
                \texttt{(append (car l) (concatena-listas-de-lista (cdr l))))} \\
                \texttt{l = '((1 2) (3 4) (4 6))} \\
                \texttt{concatena-listas-de-lista} \\
                \hline
            \end{tabular}
        \end{center}

        Sale \texttt{(concatena-listas-de-lista '())}
        \begin{center}
            \begin{tabular}{|c|}
                \hline
                \texttt{(append '(4 6) '())} \\
                \texttt{(if (empty? l) empty} \\
                \texttt{(append (car l) (concatena-listas-de-lista (cdr l))))} \\
                \texttt{l = '((4 6))} \\
                \texttt{concatena-listas-de-lista} \\
                \hline
                \hline
                \texttt{(append '(3 4) 
                (concatena-listas-de-lista '((4 6))))}  \\
                \texttt{(if (empty? l) empty} \\
                \texttt{(append (car l) (concatena-listas-de-lista (cdr l))))} \\
                \texttt{l = '((3 4) (4 6))} \\
                \texttt{concatena-listas-de-lista} \\
                \hline
                \hline
                \texttt{(append '(1 2) 
                (concatena-listas-de-lista '((3 4) (4 6))))}  \\
                \texttt{(if (empty? l) empty} \\
                \texttt{(append (car l) (concatena-listas-de-lista (cdr l))))} \\
                \texttt{l = '((1 2) (3 4) (4 6))} \\
                \texttt{concatena-listas-de-lista} \\
                \hline
            \end{tabular}
        \end{center}
        
        Sale \texttt{(concatena-listas-de-lista '((4 6)))}
        \begin{center}
            \begin{tabular}{|c|}
                \hline
                \texttt{(append '(3 4) '(4 6))}  \\
                \texttt{(if (empty? l) empty} \\
                \texttt{(append (car l) (concatena-listas-de-lista (cdr l))))} \\
                \texttt{l = '((3 4) (4 6))} \\
                \texttt{concatena-listas-de-lista} \\
                \hline
                \hline
                \texttt{(append '(1 2) 
                (concatena-listas-de-lista '((3 4) (4 6))))}  \\
                \texttt{(if (empty? l) empty} \\
                \texttt{(append (car l) (concatena-listas-de-lista (cdr l))))} \\
                \texttt{l = '((1 2) (3 4) (4 6))} \\
                \texttt{concatena-listas-de-lista} \\
                \hline
            \end{tabular}
        \end{center}

        Sale \texttt{(concatena-listas-de-lista '((3 4) (4 6)))}
        \begin{center}
            \begin{tabular}{|c|}
                \hline
                \texttt{(append '(1 2) '(3 4 4 6))}  \\
                \texttt{(if (empty? l) empty} \\
                \texttt{(append (car l) (concatena-listas-de-lista (cdr l))))} \\
                \texttt{l = '((1 2) (3 4) (4 6))} \\
                \texttt{concatena-listas-de-lista} \\
                \hline
            \end{tabular}
        \end{center}

        Sale \texttt{(concatena-listas-de-lista '((1 2) (3 4) (4 6)))}
        \begin{center}
            \begin{tabular}{|c|}
                \hline
                '(1 2 3 4 4 6) \\
                \hline
            \end{tabular}
        \end{center}

        % Ejercicio 2.c
        \item Optimiza la función usando la técnica de recursión de cola.

        \textsc{Solución:}
        \begin{verbatim}
        (define (concatena-listas-de-lista l)
          (concatena-listas-de-lista-tail l '()))
          
        (define (concatena-listas-de-lista-tail l acc)
          (if (empty? l)
              acc
              (concatena-listas-de-lista-tail (cdr l) (append acc (car l)))))
        \end{verbatim}

        % Ejercicio 2.d
        \item Muestra los registros generados por la función del inciso anterior
        con el argumento \texttt{'((1 2) (3 4) (4 6))}. ¿Cuántos registros son
        generados? ¿Cuántos son ocupados a la vez?

        \textsc{Solución:} Veamos que se generan $5$ registros de activación y 
        que $4$ de estos registros son ocupados a la vez.

        Entra \texttt{concatena-listas-de-lista '((1 2) (3 4) (4 6)))}
        \begin{center}
            \begin{tabular}{|c|}
                \hline
                \texttt{(concatena-listas-de-lista-tail 
                '((1 2) (3 4) (4 6)) '())} \\
                \texttt{(concatena-listas-de-lista-tail l '())} \\
                \texttt{l = '((1 2) (3 4) (4 6))} \\
                \texttt{concatena-listas-de-lista} \\
                \hline
            \end{tabular}
        \end{center}

        Ingresa$/$Sale \texttt{(concatena-listas-de-lista-tail 
        '((1 2) (3 4) (4 6)) '())}.
        \begin{center}
            \begin{tabular}[h]{|c|}
                \hline
                \texttt{(concatena-listas-de-lista-tail '((3 4) (4 6))
                '(1 2))} \\
                \texttt{(if (empty? l) acc} \\
                \texttt{(concatena-listas-de-lista-tail (cdr l) 
                (append acc (car l))))} \\
                \texttt{l = '((1 2) (3 4) (4 6)), acc = '()} \\
                \texttt{concatena-listas-de-lista-tail} \\
                \hline
            \end{tabular}
        \end{center}

        Ingresa$/$Sale \texttt{(concatena-listas-de-lista-tail '((3 4) (4 6))
        '(1 2))}
        \begin{center}
            \begin{tabular}[h]{|c|}
                \hline
                \texttt{(concatena-listas-de-lista-tail '((4 6)) '(1 2 3 4))} \\
                \texttt{(if (empty? l) acc} \\
                \texttt{(concatena-listas-de-lista-tail (cdr l) 
                (append acc (car l))))} \\
                \texttt{l = '((3 4) (4 6)), acc = '(1 2)} \\
                \texttt{concatena-listas-de-lista-tail} \\
                \hline
            \end{tabular}
        \end{center}

        Ingresa$/$Sale \texttt{(concatena-listas-de-lista-tail '((4 6)) 
        '(1 2 3 4))} 
        \begin{center}
            \begin{tabular}[h]{|c|}
                \hline
                \texttt{(concatena-listas-de-lista-tail '() '(1 2 3 4 4 6))} \\
                \texttt{(if (empty? l) acc} \\
                \texttt{(concatena-listas-de-lista-tail (cdr l) 
                (append acc (car l))))} \\
                \texttt{l = '((4 6)), acc = '(1 2 3 4)} \\
                \texttt{concatena-listas-de-lista-tail} \\
                \hline
            \end{tabular}
        \end{center}

        \newpage
        Ingresa$/$Sale \texttt{(concatena-listas-de-lista-tail '() '(1 2 3 4 4 6))}
        \begin{center}
            \begin{tabular}[h]{|c|}
                \hline
                \texttt{'(1 2 3 4 4 6)} \\
                \texttt{(if (empty? l) acc} \\
                \texttt{(concatena-listas-de-lista-tail (cdr l) 
                (append acc (car l))))} \\
                \texttt{l = '(), acc = '(1 2 3 4 4 6)} \\
                \texttt{concatena-listas-de-lista-tail} \\
                \hline
            \end{tabular}
        \end{center}
    \end{enumerate}

    % Ejercicio 3.
    \item Dada la siguiente función 
    \begin{verbatim}
    (define (foo n)
        (if (< n 10)
            n
            (+ (modulo n 10) (foo (quotient n 10)))))
    \end{verbatim}

    \begin{enumerate}
        % Ejercicio 3.a
        \item Explica qué hace y dale un nombre mnemotécnico.
        
        \textsc{Solución:} La expresión \texttt{(quotient n 10)} divide al 
        número $n$ entre $10$, por lo que elimina el último dígito del número 
        $n$, y la expresión \texttt{modulo n 10} regresa el residuo de la 
        división $n$ entre $10$. Así, la función \texttt{foo} regresa la suma 
        de los residuos de las divisiones de n (quitándole la última cifra 
        a $n$ en cada llamada) entre $10$. Por lo tanto, un nombre 
        mnemotécnico podría ser \texttt{suma-residuos}. De esta manera, la 
        función queda de la siguiente forma:
        \begin{verbatim}
        (define (suma-residuos n)
          (if (< n 10)
              n
              (+ (modulo n 10) (suma-residuos (quotient n 10)))))
        \end{verbatim}

        % Ejercicio 3.b
        \item Muestra los registros generados cuando es llamada con el 
        argumento $1729$. ¿Cuántos registros son generados? ¿Cuántos son 
        ocupados a la vez?

        \texttt{Solución:} Veamos que se generan $5$ registros de activación 
        y que ningún registro es ocupado a la vez.

        Ingresa \texttt{(suma-residuos 1729)}
        \begin{center}
            \begin{tabular}[h]{|c|}
                \hline
                \texttt{(+ 9 (suma-residuos 172))} \\
                \texttt{(if (< n 10) n} \\
                \texttt{(+ (modulo n 10) (suma-residuos (quotient n 10))))} \\ 
                \texttt{n = 1729} \\
                \texttt{suma-residuos} \\
                \hline
            \end{tabular}
        \end{center}

        Ingresa \texttt{(suma-residuos 172)}
        \begin{center}
            \begin{tabular}[h]{|c|}
                \hline
                \texttt{(+ 2 (suma-residuos 17))} \\
                \texttt{(if (< n 10) n} \\
                \texttt{(+ (modulo n 10) (suma-residuos (quotient n 10))))} \\ 
                \texttt{n = 172} \\
                \texttt{suma-residuos} \\
                \hline
                \hline
                \texttt{(+ 9 (suma-residuos 172))} \\
                \texttt{(if (< n 10) n} \\
                \texttt{(+ (modulo n 10) (suma-residuos (quotient n 10))))} \\ 
                \texttt{n = 1729} \\
                \texttt{suma-residuos} \\
                \hline
            \end{tabular}
        \end{center}

        \newpage
        Ingresa \texttt{(suma-residuos 17)}
        \begin{center}
            \begin{tabular}[h]{|c|}
                \hline
                \texttt{(+ 7 (suma-residuos 1))} \\
                \texttt{(if (< n 10) n} \\
                \texttt{(+ (modulo n 10) (suma-residuos (quotient n 10))))} \\ 
                \texttt{n = 17} \\
                \texttt{suma-residuos} \\
                \hline
                \hline
                \texttt{(+ 2 (suma-residuos 17))} \\
                \texttt{(if (< n 10) n} \\
                \texttt{(+ (modulo n 10) (suma-residuos (quotient n 10))))} \\ 
                \texttt{n = 172} \\
                \texttt{suma-residuos} \\
                \hline
                \hline
                \texttt{(+ 9 (suma-residuos 172))} \\
                \texttt{(if (< n 10) n} \\
                \texttt{(+ (modulo n 10) (suma-residuos (quotient n 10))))} \\ 
                \texttt{n = 1729} \\
                \texttt{suma-residuos} \\
                \hline
            \end{tabular}
        \end{center}

        Ingresa \texttt{(suma-residuos 1)}
        \begin{center}
            \begin{tabular}[h]{|c|}
                \hline
                \texttt{1} \\
                \texttt{(if (< n 10) n} \\
                \texttt{(+ (modulo n 10) (suma-residuos (quotient n 10))))} \\ 
                \texttt{n = 1} \\
                \texttt{suma-residuos} \\
                \hline
                \hline
                \texttt{(+ 7 (suma-residuos 1))} \\
                \texttt{(if (< n 10) n} \\
                \texttt{(+ (modulo n 10) (suma-residuos (quotient n 10))))} \\ 
                \texttt{n = 17} \\
                \texttt{suma-residuos} \\
                \hline
                \hline
                \texttt{(+ 2 (suma-residuos 17))} \\
                \texttt{(if (< n 10) n} \\
                \texttt{(+ (modulo n 10) (suma-residuos (quotient n 10))))} \\ 
                \texttt{n = 172} \\
                \texttt{suma-residuos} \\
                \hline
                \hline
                \texttt{(+ 9 (suma-residuos 172))} \\
                \texttt{(if (< n 10) n} \\
                \texttt{(+ (modulo n 10) (suma-residuos (quotient n 10))))} \\ 
                \texttt{n = 1729} \\
                \texttt{suma-residuos} \\
                \hline
            \end{tabular}
        \end{center}

        \newpage
        Sale \texttt{(suma-residuos 1)}
        \begin{center}
            \begin{tabular}[h]{|c|}
                \hline
                \texttt{(+ 7 1)} \\
                \texttt{(if (< n 10) n} \\
                \texttt{(+ (modulo n 10) (suma-residuos (quotient n 10))))} \\ 
                \texttt{n = 17} \\
                \texttt{suma-residuos} \\
                \hline
                \hline
                \texttt{(+ 2 (suma-residuos 17))} \\
                \texttt{(if (< n 10) n} \\
                \texttt{(+ (modulo n 10) (suma-residuos (quotient n 10))))} \\ 
                \texttt{n = 172} \\
                \texttt{suma-residuos} \\
                \hline
                \hline
                \texttt{(+ 9 (suma-residuos 172))} \\
                \texttt{(if (< n 10) n} \\
                \texttt{(+ (modulo n 10) (suma-residuos (quotient n 10))))} \\ 
                \texttt{n = 1729} \\
                \texttt{suma-residuos} \\
                \hline
            \end{tabular}
        \end{center}

        Sale \texttt{(suma-residuos 17)}
        \begin{center}
            \begin{tabular}[h]{|c|}
                \hline
                \texttt{(+ 2 8)} \\
                \texttt{(if (< n 10) n} \\
                \texttt{(+ (modulo n 10) (suma-residuos (quotient n 10))))} \\ 
                \texttt{n = 172} \\
                \texttt{suma-residuos} \\
                \hline
                \hline
                \texttt{(+ 9 (suma-residuos 172))} \\
                \texttt{(if (< n 10) n} \\
                \texttt{(+ (modulo n 10) (suma-residuos (quotient n 10))))} \\ 
                \texttt{n = 1729} \\
                \texttt{suma-residuos} \\
                \hline
            \end{tabular}
        \end{center}

        Sale \texttt{(suma-residuos 172)}
        \begin{center}
            \begin{tabular}[h]{|c|}
                \hline
                \texttt{(+ 9 10)} \\
                \texttt{(if (< n 10) n} \\
                \texttt{(+ (modulo n 10) (suma-residuos (quotient n 10))))} \\ 
                \texttt{n = 1729} \\
                \texttt{suma-residuos} \\
                \hline
            \end{tabular}
        \end{center}

        Sale \texttt{(suma-residuos 1729)}
        \begin{center}
            \begin{tabular}[h]{|c|}
                \hline
                19 \\
                \hline
            \end{tabular}
        \end{center}

        % Ejercicio 3.c
        \item Optimiza la función usando la técnica de recursión de cola.

        % Ejercicio 3.c
        \item Muestra los registros generados por la función del inciso anterior 
        con el argumento $1729$. ¿Cuántos registros son generados? ¿Cuántos son 
        ocupados a la vez?
    \end{enumerate}

    % Ejercicio 4.
    \item Dada la siguiente función 
    \begin{verbatim}
    (define (hoo n l)
        (if (zero? n)
            l
            (hoo (sub1 n) (cdr l))))
    \end{verbatim}

    \begin{enumerate}
        % Ejercicio 4.a
        \item Explica qué hace y dale un nombre mnemotécnico.
        
        \textsc{Solución:}

        % Ejercicio 4.b
        \item Muestra los registros generados cuando es llamada con los 
        argumentos $3$ y \texttt{'(1 2 3 4)}. ¿Cuántos registros son generados?
        ¿Cuántos son ocupados a la vez?

        % Ejercicio 4.c
        \item Optimiza la función usando la técnica de recursión de cola.
        
        \textsc{Solución:}
        \begin{verbatim}
        (define (drop n l)
          (drop-tail n l l))
          
        (define (drop-tail n l acc)
          (if (zero? n)
              l
              (drop-tail (sub1 n) (cdr l) acc)))
        \end{verbatim}

        % Ejercicio 4.d
        \item Muestra los registros generados por la función del inciso anterior
        con los argumentos $3$ y \texttt{'(1 2 3 4)}. ¿Cuántos registros son 
        generados? ¿Cuántos son ocupados a la vez?
    \end{enumerate}

    \newpage
    % Ejercicio 5.
    \item Evalúa la siguiente expresión usando el intérprete para cajas visto 
    en clase. Debes usar alcance estático y evaluación glotona. Mostrar el 
    ambiente (stack) y memoria (heap) finales.
    \begin{verbatim}
    {with {a newbox 17}
       {with {b {newbox 29}}
          {with {foo {fun {} {setbox a {openbox a}}}}
             {with foo {fun {} {setbox b {openbox a}}}}
                {seqn {foo}
                   {+ {openbox a} {openbox b}}}}}}
    \end{verbatim}

    \textsc{Solución:} La expresión que debemos evaluar es 
    \texttt{\{seqn \{foo\} \{+ \{openbox a\} \{openbox b\}\}\}}, por lo que 

    % Ejercicio 6.
    \item Dada la definición de la función \texttt{next-location} que genera 
    nuevas direcciones de memoria, vista en clase, modifícala para que no 
    tenga efectos secundarios, es decir, que no dependa de ninguna variable
    externa. 
    
    \textit{Hint: Modifícala usando la técnica Store Passing Style}
    \begin{verbatim}
    (define last-location -1) ;; al inicio del intérprete

    ;; next-location: number
    (define (next-location)
       (begin 
          (set! last-location (add1 last-location))
          last-location))
    \end{verbatim}
\end{enumerate}

\end{document}
